<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>캠페인 등록 - ALPA</title>

  <!-- 공통 CSS -->
  <link rel="stylesheet" href="/alpa/frontend/css/main.css?v=0815" />
  <!-- 페이지 전용 CSS -->
  <link rel="stylesheet" href="/alpa/frontend/css/campaign-form.css?v=0819a" />
  <style>
    /* ===== 페이지 보강 스타일 (복붙 OK) ===== */

    /* 헤더 숨김(상단 탭만) */
    body[data-page="campaign-form"] #header-container{ display:none !important; }

    /* 페이지 상단 여백: 네이버식 2px */
    .cf-wrap{ margin-top: calc(var(--banner-h) + var(--top-h) + 2px); }

    /* 하단 고정 액션바 */
    .cf-actions{
      position: sticky;
      bottom: calc(64px + var(--safe-bottom));
      display:flex; gap:10px; justify-content:flex-end;
      padding:10px 0 14px;
      background:linear-gradient(180deg, rgba(255,255,255,.0), rgba(255,255,255,1) 38%);
      z-index:5;
    }
    .cf-primary,.cf-secondary{ min-width:112px; height:48px; border-radius:12px; font-weight:800 }
    .cf-primary{ background:var(--pri); color:#fff; border:0 }
    .cf-secondary{ background:#eef0f5; color:#374151; border:0 }

    /* 필드/그리드 */
    .cf-field{ margin:12px 0; }
    .cf-field > label{ display:block; font-weight:800; margin-bottom:6px; }
    .cf-help{ color:#6b7280; font-size:12px; margin-top:4px; }
    .cf-grid{ display:grid; grid-template-columns: 1fr 1fr; gap:12px; }
    @media (max-width:640px){ .cf-grid{ grid-template-columns:1fr; } }

    /* 섹션 */
    .cf-block{ margin:18px 0; }
    .cf-h2{ margin:0 0 8px; font-size:18px; font-weight:900; }

    /* 파일 UI */
    .cf-thumb{ display:flex; gap:12px; align-items:flex-start; }
    .cf-thumb img{ width:160px; aspect-ratio:16/9; object-fit:cover; border-radius:10px; background:#f3f4f6; border:1px solid #e5e7eb; }
    .cf-file-ctrls{ display:flex; align-items:center; gap:8px; }
    .btn{ padding:8px 12px; border-radius:10px; background:#6C63FF; color:#fff; font-weight:800; border:0; }

    /* 시간 2개 나란히 */
    .cf-time-row{ display:grid; grid-template-columns: 1fr 1fr; gap:12px; }
    .cf-duration{ margin-top:6px; color:#6b7280; font-weight:700; }

    /* 숫자 입력 + 접미사 */
    .cf-input-suffix{ position:relative; display:flex; align-items:center; }
    .cf-input-suffix input{ width:100%; padding-right:48px; }
    .cf-input-suffix .suffix{
      position:absolute; right:10px; color:#6b7280; font-weight:800;
    }

    /* 체크박스 한 줄 */
    .cf-checkbox{ display:flex; align-items:center; gap:8px; }
    .cf-checkbox input[type="checkbox"]{ width:18px; height:18px; }

    /* ⚠️ 이전 버전의 [data-when="..."] 기본 숨김 제거! */
  </style>
</head>
<body data-page="campaign-form">
  <!-- 고정 스택 -->
  <div id="banner-container" class="lv-banner"></div>
  <header id="header-container" class="lv-header"></header>
  <nav id="top-tab-container" class="lv-top"></nav>

  <main class="cf-wrap" aria-labelledby="cfPageTitle">
    <h1 id="cfPageTitle" class="cf-title">캠페인 등록</h1>
    <p id="cfNotice" class="cf-notice" hidden></p>

    <form id="campaignForm" class="cf-form" autocomplete="off">

      <!-- 내부용 캠페인 제목 -->
      <section class="cf-block">
        <h2 class="cf-h2">캠페인 제목(내부용)</h2>
        <div class="cf-field">
          <label for="cfCampaignTitle">캠페인 제목</label>
          <input id="cfCampaignTitle" type="text" placeholder="예) 9월 2주차 뷰티 런칭" />
          <div class="cf-help">본인에게만 보이는 메모용 제목입니다. 외부에 노출되지 않습니다.</div>
        </div>
      </section>

      <!-- 유형 -->
      <section class="cf-block">
        <h2 class="cf-h2">캠페인 유형</h2>
        <div class="cf-seg">
          <label class="cf-seg-item">
            <input type="radio" name="cfType" value="product" checked />
            <span>상품 캠페인</span>
          </label>
          <label class="cf-seg-item">
            <input type="radio" name="cfType" value="recruit" />
            <span>쇼호스트 모집</span>
          </label>
        </div>
      </section>

      <!-- 공개 제목 + 브랜드 (타입별로 보여줌) -->
      <section class="cf-block">
        <h2 class="cf-h2">공개 정보</h2>

        <!-- 상품 전용 -->
        <div class="cf-grid" data-when="product">
          <div class="cf-field">
            <label for="cfTitle">제목<span class="req">*</span></label>
            <input id="cfTitle" type="text" placeholder="상품 캠페인 제목 (외부 노출)" />
            <div class="cf-help">사용자에게 실제로 노출되는 제목입니다.</div>
          </div>
          <div class="cf-field">
            <label for="cfBrand">브랜드명</label>
            <input id="cfBrand" type="text" placeholder="예) MAC" />
          </div>
        </div>

        <!-- 모집 전용 -->
        <div class="cf-grid" data-when="recruit">
          <div class="cf-field">
            <label for="cfTitleRecruit">제목<span class="req">*</span></label>
            <input id="cfTitleRecruit" type="text" placeholder="모집 공고 제목 (외부 노출)" />
            <div class="cf-help">사용자에게 실제로 노출되는 제목입니다.</div>
          </div>
          <div class="cf-field">
            <label for="cfBrandRecruit">브랜드명</label>
            <input id="cfBrandRecruit" type="text" placeholder="예) ABC몰" />
          </div>
        </div>
      </section>

      <!-- 대표 썸네일 -->
      <section class="cf-block">
        <h2 class="cf-h2">대표 썸네일</h2>
        <div class="cf-field">
          <label for="cfThumb">대표 이미지</label>
          <div class="cf-thumb">
            <img id="cfThumbPreview" alt="미리보기" />
            <div class="cf-file-ctrls">
              <button type="button" id="cfThumbBtn" class="btn">이미지 선택</button>
              <progress id="cfUploadProg" max="100" value="0" hidden></progress>
            </div>
            <input id="cfThumb" type="file" accept="image/*" hidden />
            <input type="hidden" id="cfImageUrl" />
          </div>
          <small class="cf-help">이미지 선택 시 자동 업로드됩니다.</small>
        </div>
      </section>

      <!-- (선택1) 상품 캠페인 -->
      <section id="cfSectionProduct" class="cf-block" data-mode="product">
        <h2 class="cf-h2">상품 등록</h2>

        <div class="cf-grid">
          <div class="cf-field">
            <label for="cfProdUrl">상품 URL</label>
            <input id="cfProdUrl" type="url" placeholder="네이버/쿠팡/지마켓 등 상품 URL" />
            <small class="cf-help">URL 입력 후 ‘불러오기’를 누르면 메타(썸네일/상품명/가격)를 시도합니다.</small>
          </div>
          <div class="cf-field cf-field-button">
            <button type="button" id="cfProdFetchBtn" class="cf-btn-outlined">불러오기</button>
          </div>
        </div>

        <div class="cf-field">
          <label>등록된 상품</label>
          <div id="cfProdList" class="cf-prods" aria-live="polite">
            <div class="cf-empty">아직 등록된 상품이 없습니다.</div>
          </div>
        </div>

        <div class="cf-grid">
          <div class="cf-field">
            <label for="cfSalePrice">공통 할인가(선택)</label>
            <input id="cfSalePrice" type="number" inputmode="decimal" placeholder="예) 19900" />
          </div>
          <div class="cf-field">
            <label for="cfSaleDuration">할인 유지시간 (최대 3시간)</label>
            <select id="cfSaleDuration">
              <option value="">설정 안 함</option>
              <option value="3600">1시간</option>
              <option value="7200">2시간</option>
              <option value="10800">3시간 (최대)</option>
            </select>
          </div>
        </div>

        <div class="cf-grid">
          <div class="cf-field">
            <label for="cfLiveDate">라이브 날짜</label>
            <input id="cfLiveDate" type="date" />
          </div>
          <div class="cf-field">
            <label for="cfLiveTime">라이브 시간</label>
            <input id="cfLiveTime" type="time" />
          </div>
        </div>

        <div class="cf-grid">
          <div class="cf-field">
            <label for="cfCategorySel">상품군</label>
            <select id="cfCategorySel">
              <option value="">선택하세요</option>
            </select>
          </div>
        </div>

        <div class="cf-field">
          <label for="cfDesc">상세 설명 (HTML 가능)</label>
          <textarea id="cfDesc" rows="7" placeholder="상세페이지 소개/가이드/주의사항 등을 작성하세요."></textarea>
        </div>
      </section>

      <!-- (선택2) 쇼호스트 모집 -->
      <section id="cfSectionRecruit" class="cf-block" data-mode="recruit" hidden>
        <h2 class="cf-h2">쇼호스트 모집</h2>

        <div class="cf-grid">
          <div class="cf-field">
            <label for="cfDate">촬영일 <span class="req">*</span></label>
            <input id="cfDate" type="date" />
          </div>
          <div class="cf-field">
            <label for="cfDeadline">모집 마감일</label>
            <input id="cfDeadline" type="date" />
          </div>
        </div>

        <div class="cf-field">
          <label>촬영시간</label>
          <div class="cf-time-row">
            <input id="cfTimeStart" type="time" aria-label="시작시간" />
            <input id="cfTimeEnd" type="time" aria-label="종료시간" />
          </div>
          <div id="cfDuration" class="cf-duration">촬영시간: -</div>
        </div>

        <div class="cf-field">
          <label for="cfLocation">촬영 장소</label>
          <input id="cfLocation" type="text" placeholder="예) 서울 강남구 ○○스튜디오" />
        </div>

        <div class="cf-grid">
          <div class="cf-field">
            <label for="cfPayWan">출연료</label>
            <div class="cf-input-suffix">
              <input id="cfPayWan" type="tel" inputmode="numeric" placeholder="숫자만 입력 (예: 30)">
              <span class="suffix">만원</span>
            </div>
            <div id="cfPayWanPreview" class="cf-help"></div>
          </div>
          <div class="cf-field cf-checkbox">
            <label><input id="cfPayNeg" type="checkbox" /> 협의 가능</label>
          </div>
        </div>

        <div class="cf-grid">
          <div class="cf-field">
            <label for="cfCategoryRecruitSel">카테고리</label>
            <select id="cfCategoryRecruitSel">
              <option value="">선택하세요</option>
            </select>
          </div>
        </div>

        <div class="cf-field">
          <label for="cfDescRecruit">요구사항/우대사항</label>
          <textarea id="cfDescRecruit" rows="7" placeholder="방송 내용, 요구 스킬, 우대사항 등을 상세히 적어주세요."></textarea>
        </div>
      </section>

      <div class="cf-actions">
        <button type="button" class="cf-secondary" id="cfCancelBtn">취소</button>
        <button type="submit" class="cf-primary" id="cfSubmitBtn">등록하기</button>
      </div>

      <!-- 상품 카드 템플릿 -->
      <template id="cfProdItemTpl">
        <article class="cf-prod">
          <img class="cf-prod-thumb" alt="" />
          <div class="cf-prod-body">
            <div class="cf-prod-title"></div>
            <div class="cf-prod-meta">
              <span class="price"></span>
              <span class="sale"></span>
            </div>
            <div class="cf-prod-actions">
              <button type="button" class="cf-btn-outlined" data-act="edit">수정</button>
              <button type="button" class="cf-btn-danger" data-act="remove">삭제</button>
            </div>
          </div>
        </article>
      </template>
    </form>
  </main>

  <nav id="bottom-tab-container" class="lv-bottom"></nav>

  <!-- 공통 모듈 -->
  <script src="/alpa/frontend/js/modules/banner.js"></script>
  <script src="/alpa/frontend/js/modules/header.js"></script>
  <script src="/alpa/frontend/js/modules/top-tab.js"></script>
  <script src="/alpa/frontend/js/modules/bottom-tab.js"></script>
  <script src="/alpa/frontend/js/config.js?v=0819a"></script>

  <!-- 페이지 JS (리팩토링 버전과 매칭) -->
  <script src="/alpa/frontend/js/campaign-form.js?v=0819c"></script>

  <!-- 유형 토글 + data-when 제어 -->
  <script>
  (function(){
    const radios = document.querySelectorAll('input[name="cfType"]');
    const secP = document.getElementById('cfSectionProduct');
    const secR = document.getElementById('cfSectionRecruit');
    const whenEls = document.querySelectorAll('[data-when]');

    function apply(){
      const v = document.querySelector('input[name="cfType"]:checked')?.value || 'product';
      secP.hidden = v !== 'product';
      secR.hidden = v !== 'recruit';
      whenEls.forEach(el=>{
        const t = el.getAttribute('data-when');
        el.style.display = (t === v) ? '' : 'none';
      });
    }
    radios.forEach(r=>r.addEventListener('change', apply));
    apply();

    // 커스텀 파일 버튼
    document.getElementById('cfThumbBtn')?.addEventListener('click', () => {
      document.getElementById('cfThumb')?.click();
    });
  })();
  </script>
</body>
</html>