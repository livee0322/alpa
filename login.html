<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>로그인 - ALPA</title>
  <!-- 공통 스타일 -->
  <link rel="stylesheet" href="/alpa/frontend/css/main.css?v=0811s" />
  <!-- 페이지 전용(있다면 유지) -->
  <link rel="stylesheet" href="/alpa/frontend/css/login.css?v=0815y" />
</head>
<body data-page="login">
  <!-- 고정 상단 스택 -->
  <div id="banner-container" class="lv-banner"></div>
  <header id="header-container" class="lv-header"></header>
  <nav id="top-tab-container" class="lv-top"></nav>

  <!-- 페이지 콘텐츠 -->
  <main class="lg-wrap" role="main">
    <h1 class="lg-title">로그인</h1>

    <!-- 역할 선택 -->
    <div class="su-role" role="tablist" aria-label="역할 선택">
      <button type="button" class="su-pill" data-role="brand" aria-pressed="true">브랜드</button>
      <button type="button" class="su-pill" data-role="showhost" aria-pressed="false">쇼호스트</button>
    </div>

    <form id="loginForm" class="lg-form" novalidate>
      <label class="lg-label" for="email">Email</label>
      <input type="email" id="email" name="email" placeholder="you@example.com" required
             autocomplete="username" inputmode="email" />

      <label class="lg-label" for="password">Password</label>
      <input type="password" id="password" name="password" placeholder="••••••••" required
             autocomplete="current-password" />

      <button id="loginBtn" type="submit" class="lg-submit">로그인</button>
      <p id="loginError" class="lg-error" hidden></p>
    </form>

    <p class="lg-links">아직 계정이 없으신가요? <a href="/alpa/signup.html">회원가입</a></p>
  </main>

  <!-- 고정 하단 탭 -->
  <nav id="bottom-tab-container" class="lv-bottom"></nav>

  <!-- 공통 모듈 & 설정 (순서 중요) -->
  <script defer src="/alpa/frontend/js/modules/banner.js"></script>
  <script defer src="/alpa/frontend/js/modules/header.js"></script>
  <script defer src="/alpa/frontend/js/modules/top-tab.js"></script>
  <script defer src="/alpa/frontend/js/modules/bottom-tab.js"></script>
  <script defer src="/alpa/frontend/js/config.js?v=0811c"></script>

  <!-- 로그인 로직 -->
  <script defer src="/alpa/frontend/js/login.js?v=0811c"></script>

  <!-- 역할 토글 + 레이아웃 오프셋 적용 -->
  <script>
    // 역할 토글 (상태 저장)
    (function roleToggle(){
      const pills = document.querySelectorAll('.su-pill');
      let role = localStorage.getItem('lastRole') || 'brand';
      const apply = (activeRole) => {
        pills.forEach(p => {
          const on = p.dataset.role === activeRole;
          p.classList.toggle('active', on);
          p.setAttribute('aria-pressed', String(on));
        });
      };
      apply(role);
      pills.forEach(p => p.addEventListener('click', () => {
        role = p.dataset.role; localStorage.setItem('lastRole', role); apply(role);
      }));
    })();

    // 상단/하단 고정요소 실제 높이를 읽어 CSS 변수에 주입 → 컨텐츠 가림 방지
    (function layoutOffsets(){
      const r = document.documentElement;
      const $$ = (id) => document.getElementById(id);

      function px(n){ return n ? (n|0) + 'px' : '0px'; }
      function measure(){
        // 높이 측정
        const bh = $$('.banner-container')?.offsetHeight || $$('#banner-container')?.offsetHeight || 0;
        const hh = $$('#header-container')?.offsetHeight || 0;
        const th = $$('#top-tab-container')?.offsetHeight || 0;
        const bot = $$('#bottom-tab-container')?.offsetHeight || 0;

        r.style.setProperty('--banner-h', px(bh));
        r.style.setProperty('--header-h', px(hh || 56));
        r.style.setProperty('--top-h',    px(th || 48));
        r.style.setProperty('--bottom-h', px(bot || 72));
        // stack-h 는 main.css에서 calc로 계산됨
      }

      // 초기 2프레임 + 모듈 로딩 이후 + 리사이즈/폰트로드 대응
      requestAnimationFrame(measure);
      window.addEventListener('load', measure, { once:true });
      window.addEventListener('resize', () => { clearTimeout(measure._t); measure._t = setTimeout(measure, 100); });

      // 동적으로 배너/탭이 바뀌는 경우 감지
      const obs = new MutationObserver(measure);
      ['banner-container','header-container','top-tab-container','bottom-tab-container']
        .forEach(id => { const el = document.getElementById(id); if (el) obs.observe(el, { childList:true, subtree:true }); });
    })();
  </script>
</body>
</html>